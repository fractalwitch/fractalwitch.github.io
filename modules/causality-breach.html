<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>âœ¨ Causality Breach âœ¨</title>
<link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
<style>
    :root {
        --hot-pink: #ff1493;
        --baby-pink: #ff69b4;
        --gold: #ffd700;
        --cyan: #00ffff;
        --turquoise: #40e0d0;
        --border-color: #ffffff;
        --bg-gradient: linear-gradient(135deg, #ff1493, #ff69b4, #ffd700, #40e0d0);
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    body {
        font-family: 'Comic Neue', cursive;
        background: var(--bg-gradient);
        background-size: 400% 400%;
        animation: gradientShift 15s ease infinite;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        /* Custom cursor */
        cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" style="fill:white;stroke:black;"><path d="M12 2L15 9L22 9L16 14L18 21L12 17L6 21L8 14L2 9L9 9Z"/></svg>') 12 12, auto;
    }

    @keyframes gradientShift {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    /* --- Effects Layer --- */
    .glitter-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
    }

    .sparkle {
        position: absolute;
        pointer-events: none;
        animation: sparkleAnim 1s ease-out forwards;
        font-size: 20px;
    }

    @keyframes sparkleAnim {
        0% { transform: scale(0) rotate(0deg); opacity: 1; }
        100% { transform: scale(1.5) rotate(180deg); opacity: 0; }
    }

    .dream-bubble {
        position: fixed;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(5px);
        border: 2px solid rgba(255, 255, 255, 0.6);
        border-radius: 50px;
        padding: 10px 20px;
        color: white;
        text-shadow: 0 0 5px #ff1493;
        font-weight: bold;
        pointer-events: none;
        z-index: 50;
        animation: floatUp 8s ease-in forwards;
        white-space: nowrap;
    }

    @keyframes floatUp {
        0% { transform: translateY(110vh) scale(0.8); opacity: 0; }
        10% { opacity: 1; }
        90% { opacity: 1; }
        100% { transform: translateY(-20vh) scale(1.2); opacity: 0; }
    }

    /* --- UI Components --- */
    
    .window-box {
        background: rgba(255, 255, 255, 0.25);
        backdrop-filter: blur(10px);
        border: 3px solid white;
        border-radius: 10px;
        box-shadow: 
            0 0 0 2px #ff1493,
            5px 5px 0 0 rgba(0,0,0,0.2),
            inset 0 0 20px rgba(255,255,255,0.5);
        max-width: 90%;
        width: 400px;
        padding: 2px;
        position: absolute;
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }

    /* Login Screen */
    #loginScreen {
        text-align: center;
        padding: 40px;
        display: flex; /* Flex required for center alignment */
        flex-direction: column;
        gap: 15px;
        z-index: 100;
        background: linear-gradient(135deg, rgba(255,20,147,0.9), rgba(255,215,0,0.8));
    }

    h1.title {
        color: white;
        font-size: 2.5rem;
        text-shadow: 3px 3px 0px #ff1493, -1px -1px 0 #40e0d0;
        margin-bottom: 10px;
        animation: pulseTitle 2s infinite ease-in-out;
    }

    @keyframes pulseTitle {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05) rotate(-2deg); }
    }

    input.retro-input {
        width: 100%;
        padding: 12px;
        border: 3px solid white;
        background: rgba(255,255,255,0.8);
        border-radius: 5px;
        font-family: 'Comic Neue', cursive;
        font-size: 1.1rem;
        outline: none;
        color: #ff1493;
        font-weight: bold;
        box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
    }

    button.retro-btn {
        background: linear-gradient(to bottom, #ffeb3b, #ffc107);
        border: 2px solid white;
        padding: 12px 25px;
        font-family: 'Comic Neue', cursive;
        font-weight: bold;
        font-size: 1.2rem;
        color: #ff1493;
        border-radius: 50px;
        cursor: pointer;
        text-transform: uppercase;
        box-shadow: 0 4px 0 #ff69b4, 0 5px 10px rgba(0,0,0,0.2);
        transition: transform 0.1s, box-shadow 0.1s;
    }

    button.retro-btn:active {
        transform: translateY(4px);
        box-shadow: 0 0 0 #ff69b4, inset 0 2px 5px rgba(0,0,0,0.2);
    }

    /* Messenger Interface */
    #messenger {
        display: none;
        flex-direction: column;
        height: 600px;
        width: 450px;
        background: #fff0f5; /* Lavender blush background */
        z-index: 90;
        opacity: 0;
        transform: scale(0.9);
        border: 4px solid #ff1493;
    }

    .title-bar {
        background: linear-gradient(90deg, #ff1493, #ff69b4);
        padding: 8px 12px;
        color: white;
        font-weight: bold;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid #ff1493;
        font-size: 1.1rem;
        text-shadow: 1px 1px 0 rgba(0,0,0,0.2);
    }

    .window-controls {
        display: flex;
        gap: 5px;
    }

    .control-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 1px solid rgba(255,255,255,0.8);
        box-shadow: inset 1px 1px 2px rgba(0,0,0,0.2);
    }

    #chatArea {
        flex: 1;
        padding: 15px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
        background: 
            linear-gradient(#e6e6fa 1px, transparent 1px),
            linear-gradient(90deg, #e6e6fa 1px, transparent 1px);
        background-size: 20px 20px;
        background-color: #fff;
        /* Scrollbar styling */
        scrollbar-width: thin;
        scrollbar-color: #ff69b4 #ffe4e1;
    }

    #chatArea::-webkit-scrollbar {
        width: 8px;
    }
    #chatArea::-webkit-scrollbar-track {
        background: #ffe4e1;
    }
    #chatArea::-webkit-scrollbar-thumb {
        background-color: #ff69b4;
        border-radius: 10px;
    }

    .message {
        max-width: 80%;
        padding: 10px 15px;
        border-radius: 15px;
        position: relative;
        font-size: 1rem;
        line-height: 1.4;
        animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        word-wrap: break-word;
    }

    @keyframes popIn {
        from { opacity: 0; transform: translateY(10px) scale(0.9); }
        to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .msg-them {
        align-self: flex-start;
        background: white;
        border: 2px solid #ff69b4;
        color: #ff1493;
        border-bottom-left-radius: 2px;
    }

    .msg-you {
        align-self: flex-end;
        background: #40e0d0;
        border: 2px solid #00ced1;
        color: white;
        text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
        border-bottom-right-radius: 2px;
    }

    .msg-cosmic {
        align-self: center;
        background: linear-gradient(45deg, #ff1493, #ffd700, #40e0d0);
        color: white;
        border: 2px solid white;
        text-align: center;
        font-weight: bold;
        text-shadow: 0 0 5px rgba(0,0,0,0.5);
        animation: popIn 0.5s ease, gradientFlow 3s infinite linear;
        background-size: 200% 200%;
        width: 90%;
    }

    @keyframes gradientFlow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .timestamp {
        font-size: 0.65rem;
        opacity: 0.7;
        margin-top: 4px;
        text-align: right;
        display: block;
    }

    #inputArea {
        padding: 10px;
        background: #ffe4e1;
        border-top: 2px solid #ff1493;
        display: flex;
        gap: 8px;
        align-items: center;
    }

    #messageInput {
        flex: 1;
        padding: 8px 12px;
        border: 2px solid #ff69b4;
        border-radius: 20px;
        font-family: 'Comic Neue', cursive;
        outline: none;
    }

    #sendBtn {
        background: #ff1493;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        font-weight: bold;
        cursor: pointer;
        font-family: 'Comic Neue', cursive;
        transition: background 0.2s;
    }
    #sendBtn:hover { background: #d1107a; }

    /* --- Collapse & Portal Effects --- */

    /* The Melt */
    .melting {
        animation: meltShake 0.1s infinite;
        filter: blur(1px) hue-rotate(90deg);
    }
    
    @keyframes meltShake {
        0% { transform: translate(1px, 1px) rotate(0deg); }
        10% { transform: translate(-1px, -2px) rotate(-1deg); }
        20% { transform: translate(-3px, 0px) rotate(1deg); }
        30% { transform: translate(3px, 2px) rotate(0deg); }
        40% { transform: translate(1px, -1px) rotate(1deg); }
        50% { transform: translate(-1px, 2px) rotate(-1deg); }
        60% { transform: translate(-3px, 1px) rotate(0deg); }
        70% { transform: translate(3px, 1px) rotate(-1deg); }
        80% { transform: translate(-1px, -1px) rotate(1deg); }
        90% { transform: translate(1px, 2px) rotate(0deg); }
        100% { transform: translate(1px, -2px) rotate(-1deg); }
    }

    .portal-overlay {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 0;
        height: 0;
        border-radius: 50%;
        /* Spiral Gradient */
        background: repeating-conic-gradient(
            from 0deg,
            #ff1493 0deg 10deg,
            #ffd700 10deg 20deg,
            #40e0d0 20deg 30deg,
            #ff69b4 30deg 40deg
        );
        z-index: 999;
        pointer-events: none;
        opacity: 0;
    }

    .portal-active {
        animation: expandPortal 5s cubic-bezier(0.7, 0, 0.3, 1) forwards;
    }

    @keyframes expandPortal {
        0% { width: 0; height: 0; opacity: 1; transform: translate(-50%, -50%) rotate(0deg); }
        100% { width: 300vmax; height: 300vmax; opacity: 1; transform: translate(-50%, -50%) rotate(1080deg); }
    }

    .light-curtain {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: white;
        z-index: 1000;
        opacity: 0;
        pointer-events: none;
    }

    .curtain-wash {
        animation: washAway 4s ease-in-out forwards;
    }

    @keyframes washAway {
        0% { opacity: 0; }
        40% { opacity: 1; }
        60% { opacity: 1; }
        100% { opacity: 0; }
    }

</style>
</head>
<body>

    <!-- Effect Layers -->
    <div class="glitter-container" id="glitterContainer"></div>
    <div class="portal-overlay" id="portal"></div>
    <div class="light-curtain" id="curtain"></div>

    <!-- Login Screen -->
    <div id="loginScreen" class="window-box">
        <h1 class="title">âœ¨ Causality Breach âœ¨</h1>
        <p style="color: white; font-weight: bold; text-shadow: 1px 1px 2px rgba(0,0,0,0.2);">enter ur cosmic handle babe</p>
        <input type="text" id="usernameInput" class="retro-input" placeholder="ur name here..." maxlength="15">
        <button onclick="attemptLogin()" class="retro-btn">Log In ðŸ’‹</button>
    </div>

    <!-- Messenger Window -->
    <div id="messenger" class="window-box">
        <div class="title-bar">
            <span>ðŸ”® cosmic hotline w/ STARGIRL</span>
            <div class="window-controls">
                <div class="control-dot" style="background: #ffd700;"></div>
                <div class="control-dot" style="background: #40e0d0;"></div>
                <div class="control-dot" style="background: #ff1493;"></div>
            </div>
        </div>
        
        <div id="chatArea">
            <!-- Messages go here -->
        </div>

        <div id="inputArea">
            <input type="text" id="messageInput" placeholder="speak ur truth..." autocomplete="off">
            <button id="sendBtn" onclick="sendUserMessage()">SEND âœ¨</button>
        </div>
    </div>

<script>
    // --- State Management ---
    const state = {
        username: '',
        stage: 0, // 0: intro, 1: moon, 2: weird, 3: tension/problem, 4: breach, 5: collapse
        isTyping: false,
        breachInitiated: false
    };

    // --- DOM Elements ---
    const loginScreen = document.getElementById('loginScreen');
    const messenger = document.getElementById('messenger');
    const chatArea = document.getElementById('chatArea');
    const msgInput = document.getElementById('messageInput');
    const glitterContainer = document.getElementById('glitterContainer');

    // --- Sound Effects (Simulated visual feedback since no audio files) ---
    function triggerGlitter(x, y) {
        const glitter = document.createElement('div');
        glitter.innerHTML = ['âœ¨', 'â­', 'ðŸ’«', 'ðŸ’–'][Math.floor(Math.random() * 4)];
        glitter.className = 'sparkle';
        glitter.style.left = x + 'px';
        glitter.style.top = y + 'px';
        // Random color filter
        glitter.style.filter = `hue-rotate(${Math.random() * 360}deg)`;
        glitterContainer.appendChild(glitter);
        setTimeout(() => glitter.remove(), 1000);
    }

    document.addEventListener('click', (e) => triggerGlitter(e.clientX, e.clientY));

    // --- Core Logic ---

    function attemptLogin() {
        const name = document.getElementById('usernameInput').value.trim();
        if (name) {
            state.username = name;
            loginScreen.style.transform = "scale(0.8) translateY(-50px)";
            loginScreen.style.opacity = "0";
            setTimeout(() => {
                loginScreen.style.display = "none";
                openMessenger();
            }, 500);
        } else {
            // Shake effect for error
            loginScreen.style.transform = "translateX(5px)";
            setTimeout(() => loginScreen.style.transform = "translateX(-5px)", 50);
            setTimeout(() => loginScreen.style.transform = "translateX(0)", 100);
        }
    }

    function openMessenger() {
        messenger.style.display = 'flex';
        // Small delay for animation pop-in
        setTimeout(() => {
            messenger.style.opacity = '1';
            messenger.style.transform = 'scale(1)';
        }, 50);
        
        startScript();
    }

    function getTime() {
        const d = new Date();
        return d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
    }

    function addMessage(text, type) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `message msg-${type}`;
        msgDiv.innerHTML = `
            ${text}
            <span class="timestamp">${getTime()}</span>
        `;
        chatArea.appendChild(msgDiv);
        chatArea.scrollTop = chatArea.scrollHeight;
    }

    function botTyping(text, delay = 1000, type = 'them') {
        return new Promise(resolve => {
            state.isTyping = true;
            // "Typing..." indicator could go here
            setTimeout(() => {
                addMessage(text, type);
                state.isTyping = false;
                resolve();
            }, delay);
        });
    }

    // --- The Script ---

    async function startScript() {
        await botTyping(`OMG ${state.username} hiiiii!! ðŸ’—`, 800);
        await botTyping("did u see that full moon last night?? ðŸŒ•âœ¨", 1500);
        await botTyping("i swear i felt like the veil was SO thin", 2000);
        state.stage = 1;
    }

    async function handleUserResponse(text) {
        const lower = text.toLowerCase();

        // Stage 1: Moon/Veil Agreement -> Transition to Voice
        if (state.stage === 1) {
            await botTyping("RIGHT???? omg", 1000);
            await botTyping("okay so random but... have u been feeling weird lately?", 1800);
            await botTyping("like... strings pulling u back from stuff?? ðŸ•¸ï¸", 2000);
            state.stage = 2;
        }
        // Stage 2: The "Voice" -> Ask about desire
        else if (state.stage === 2) {
            await botTyping("YES exactly!! like there's this voice that's like", 1200);
            await botTyping(`"u need to be ready first" or "who do u think u are" ðŸ™„`, 1800);
            await botTyping("but what if... hear me out...", 1500);
            await botTyping("what if we're ALREADY ready?? ðŸ‘€âœ¨", 1500);
            await botTyping("what's something u want to do but keep waiting on?", 2000);
            state.stage = 3;
        }
        // Stage 3: The Problem (Dance specific or general)
        else if (state.stage === 3) {
            // Check for specific keywords for the 'Dance' path, but work generically too
            const isDance = lower.includes('dance') || lower.includes('dancing') || lower.includes('move');
            
            await botTyping("WAIT STOP", 1000);
            
            if (isDance) {
                await botTyping("u wanna dance but never took a class??? ðŸ’ƒ", 1500);
            } else {
                await botTyping("u want that but feel like u need permission???", 1500);
            }
            
            await botTyping("babe... BABE.", 1200);
            await botTyping("what if i told u that's backwards??", 1800);
            
            if (isDance) {
                await botTyping("what if u DANCE and THEN u become a dancer?? ðŸŒ€", 2000);
            } else {
                await botTyping("what if u DO IT and THEN u become the one who does it?? ðŸŒ€", 2000);
            }
            
            // Trigger Breach
            initiateBreach();
        }
        // Stage 4+: Glitch responses
        else if (state.stage >= 4) {
            const glitches = [
                "the timeline is softening... ðŸŒŠ",
                "can u feel the pixels melting? âœ¨",
                "REALITY IS OPTIONAL BABE",
                "desire = navigation ðŸ§­",
                "âœ¨ SYSTEM OVERRIDE âœ¨"
            ];
            await botTyping(glitches[Math.floor(Math.random() * glitches.length)], 500, 'cosmic');
        }
    }

    async function initiateBreach() {
        state.stage = 4;
        state.breachInitiated = true;

        // Visual Freakout
        await botTyping("omg wait somethings happening", 1000);
        document.body.style.animationDuration = "2s"; // Speed up background
        
        await botTyping("do u feel that???? âš¡", 1200, 'cosmic');
        spawnDreamBubbles();

        await botTyping("CAUSALITY BREACH INITIATED ðŸ’«âš¡ðŸ’«", 1500, 'cosmic');
        
        // Melt Effect
        messenger.classList.add('melting');
        
        await botTyping("babe ur ALREADY there", 1500, 'cosmic');
        await botTyping("all u gotta do is ASK âœ¨", 1500, 'cosmic');
        
        // More bubbles
        setInterval(spawnSingleBubble, 800);
        
        await botTyping("boundaries dissolving into dream ðŸ«¦", 2000, 'cosmic');
        await botTyping("where 'real' melts into INFINITE â™¾ï¸", 2000, 'cosmic');
        
        // Final Portal Trigger
        setTimeout(triggerPortal, 4000);
    }

    function spawnDreamBubbles() {
        const phrases = [
            "time is a flat circle ðŸ©",
            "glitter is valid currency âœ¨",
            "softness is power ðŸ’—",
            "u are the portal ðŸŒ€",
            "wake up babe",
            "make believe is real"
        ];
        
        phrases.forEach((txt, i) => {
            setTimeout(() => {
                const bubble = document.createElement('div');
                bubble.className = 'dream-bubble';
                bubble.innerText = txt;
                bubble.style.left = Math.random() * 80 + 10 + '%';
                bubble.style.background = `rgba(${Math.random()*255}, 100, 200, 0.4)`;
                document.body.appendChild(bubble);
            }, i * 1000);
        });
    }

    function spawnSingleBubble() {
        if(!state.breachInitiated) return;
        const bubble = document.createElement('div');
        bubble.className = 'dream-bubble';
        bubble.innerText = "âœ¨";
        bubble.style.left = Math.random() * 90 + '%';
        document.body.appendChild(bubble);
    }

    function triggerPortal() {
        const portal = document.getElementById('portal');
        const curtain = document.getElementById('curtain');
        
        portal.classList.add('portal-active');
        
        setTimeout(() => {
            curtain.classList.add('curtain-wash');
        }, 3000);

        // RESET
        setTimeout(() => {
            resetApp();
        }, 6000);
    }

    function resetApp() {
        // Clear logic
        state.username = '';
        state.stage = 0;
        state.breachInitiated = false;
        
        // Clear UI
        chatArea.innerHTML = '';
        messenger.style.display = 'none';
        messenger.classList.remove('melting');
        messenger.style.opacity = '0';
        
        // Reset Portal Styles
        const portal = document.getElementById('portal');
        const curtain = document.getElementById('curtain');
        portal.classList.remove('portal-active');
        curtain.classList.remove('curtain-wash');
        
        // Clean bubbles
        document.querySelectorAll('.dream-bubble').forEach(b => b.remove());
        
        // Reset Body Animation
        document.body.style.animationDuration = "15s";

        // Show Login
        loginScreen.style.display = 'flex';
        setTimeout(() => {
            loginScreen.style.opacity = '1';
            loginScreen.style.transform = 'scale(1)';
            document.getElementById('usernameInput').value = '';
        }, 100);
    }

    // --- Input Handling ---

    function sendUserMessage() {
        const txt = msgInput.value.trim();
        if (txt && !state.isTyping) {
            addMessage(txt, 'you');
            msgInput.value = '';
            handleUserResponse(txt);
        }
    }

    msgInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendUserMessage();
    });

</script>
</body>
</html>

